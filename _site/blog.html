<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Web, JavaScript, Blog, Nevermoi" />
    <meta property="og:site_name" content="nevermoi blog">
  
    <meta name="author" content="shuson" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    
    <title></title>
    
    <link rel="fav icon" href="/public/favicon.ico">
    <link href="/atom.xml" rel="alternate" title="" type="application/atom+xml" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/public/css/style.css">
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/retina.js/1.3.0/retina.min.js"></script>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script type="text/javascript"> hljs.initHighlightingOnLoad(); </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-85594317-1', 'auto');
      ga('send', 'pageview');

    </script>
  </head>
  <body>
      <div id="main" role="main">
        <header>
          <div id="header">
            <h1><a title="Nevermoi" class="" href="/">Nevermoi</a></h1>
          </div>
          <nav>
            
            <span><a title="Archive" href="/archive.html"><i class="fa fa-list-ul"></i></a></span>
            
            <span><a title="Tags" href="/tags.html"><i class="fa fa-tags"></i></a></span>
            
            <span><a title="About" href="/about.html"><i class="fa fa-user"></i></a></span>
            
            <span><a title="Subscribe" href="/atom.xml"><i class="fa fa-rss"></i></a></span>
            
          </nav>
        </header>
        <div id="content">
        <div>
  <ul class="listing">
  
  <article class="content">
    <section class="title">
      <h2><a href="/2016/10/13/everything-i-know-about-rsa.html">Everything I know about RSA algorithm</a></h2>
    </section>
    <section class="meta">
    <span class="time">
      <time datetime="2016-10-13">2016-10-13</time>
    </span>
    
    <span class="tags">
      
      <a href="/tags.html#cryptography" title="cryptography">#cryptography</a>
      
    </span>
    
    <!-- BEGIN this would not work on any other domain -->
    <span
      class           = 'like-wrapper'
      like-shortname  = ''
      like-identifier = '/2016/10/13/everything-i-know-about-rsa'
      like-name       = 'Everything I know about RSA algorithm'
      like-link       = '/blog.html'
      like-btn        = '&#xf087;'
    ></span>
    <script type="text/javascript">
      var l = document.createElement('script'); l.type = 'text/javascript'; l.async = true;
      l.src = 'http://www.like-btn.com/javascript/widget.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(l);
    </script>
    <!-- END this would not work on any other domain -->
    </section>
    <section class="post">
    <h2 id="section">公开密钥加密简介</h2>

<blockquote>
  <p>也称作非对称密钥加密，描述为用某用户公钥加密后所得的信息，只能用该用户的私钥才能解密。如果知道了其中一个，并不能计算出另外一个。</p>
</blockquote>

<blockquote>
  <p>下面我们主要聊最常用的RSA加密算法。</p>
</blockquote>

<h2 id="section-1">数学基础</h2>

<ul>
  <li>互质</li>
</ul>

<blockquote>
  <p>两个正整数，如果出了1之外没有其他公因子，这两个数就互为质数，简称互质。</p>
</blockquote>

<ul>
  <li>欧拉函数</li>
</ul>

<blockquote>
  <p>任意正整数n，在小于等于n的正整数中，与n互质的数的个数可记为：<img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=%5Cphi%20(n)" style="border:none;" /></p>
</blockquote>

<ul>
  <li>欧拉定理</li>
</ul>

<blockquote>
  <p>如果a, n互质, 则有<br />
    <img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=a%5E%7B%5Cphi(n)%7D%5Cequiv%5C1%20(mod%5C%20n)&amp;chs=60" style="border:none;" /></p>
</blockquote>

<ul>
  <li>欧拉定理的特例：费马小定理</li>
</ul>

<blockquote>
  <p>当p是质数，<img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=%5Cphi%20(p)%20%3D%20p%20-%201" style="border:none;" />, 则有<br />
    <img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=ab%20%5Cequiv%201%5C%20(mod%5C%20n)&amp;chs=40" style="border:none;" /></p>
</blockquote>

<ul>
  <li>模反元素</li>
</ul>

<blockquote>
  <p>由<br /> <img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=a%5E%7B%5Cphi(n)%7D%3Da%5Ctimes%20a%5E%7B%5Cphi(n)-1%7D%5Cequiv%5C%201%5C%20(mod%5C%20n)%20&amp;chs=40" style="border:none;" /> <br />可以写成：<br /><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=ab%20%5Cequiv%201%5C%20(mod%5C%20n)&amp;chs=40" style="border:none;" /> <br />这个b叫做a的模反元素</p>
</blockquote>

<ul>
  <li>扩展欧几里德算法</li>
</ul>

<blockquote>
  <p>用来求解二元一次方程的整数解</p>
</blockquote>

<h2 id="rsa">生成RSA密钥</h2>

<p>RSA算法的可靠性基于一个事实：两个大质数的乘积易得，但对这个乘积因式分解很困难。</p>

<ul>
  <li>随机选两个质数</li>
</ul>

<blockquote>
  <p>例如 p=13 和 q=23. 在实际情况中，这个质数特别大。</p>
</blockquote>

<ul>
  <li>计算乘积</li>
</ul>

<blockquote>
  <p>n = p x q = 13 x 23 = 299</p>
</blockquote>

<ul>
  <li>计算欧拉函数</li>
</ul>

<blockquote>
  <p>φ(n) = (p-1)(q-1) = 12 x 22 = 264</p>
</blockquote>

<ul>
  <li>随机选择一个整数e，条件是1&lt; e &lt; φ(n)，且e与φ(n) 互质</li>
</ul>

<blockquote>
  <p>e = 17</p>
</blockquote>

<ul>
  <li>计算e对于φ(n)的模反元素d</li>
</ul>

<blockquote>
  <p>ed ≡ 1 (mod φ(n)) 等价于 k倍的 φ(n) 加上 1 等于 ed，写作 ed = kφ(n) + 1<br />
变形为 ed + φ(n)(-k) = 1， 代入 e 和 φ(n) 的值，也就是二元一次方程 17d + 264(-k) = 1<br />
根据扩展欧几里德算法，可得 d = 233, k = 15.</p>
</blockquote>

<ul>
  <li>至此，我们拥有了</li>
</ul>

<blockquote>
  <p>p = 13, q = 23, n = 299, φ(n) = 264, e = 17. d = 233. <br />
我们把n和e包装成公钥 (299, 17)，把n和d包装成私钥 (299, 233)</p>
</blockquote>

<ul>
  <li>可靠性分析</li>
</ul>

<blockquote>
  <p>在上面的6个数字中，我们只公布了n和e，而d是最重要的私钥，如果靠n和e计算d的话</p>
</blockquote>

<pre><code>1. ed≡1 (mod φ(n))。只有知道e和φ(n)，才能算出d。
2. φ(n)=(p-1)(q-1)。只有知道p和q，才能算出φ(n)。
3. 想要知道p和q，就需要对n进行因子分解。那就难咯。
</code></pre>

<h2 id="section-2">加密和解密</h2>

<ul>
  <li>加密：有明文m=20，使用公钥对儿(n, e)加密得到c的过程 <br /></li>
</ul>

<blockquote>
  <p>根据 m<sup>e</sup> ≡ c (mod n) 计算，20<sup>17</sup> ≡ 76 (mode 299), c = 76 为密文。</p>
</blockquote>

<ul>
  <li>解密：对于密文c=76, 有<br /></li>
</ul>

<blockquote>
  <p>c<sup>d</sup> ≡ m (mod n) 计算， 76<sup>233</sup> ≡ 20 (mode 299), 解密出m=20</p>
</blockquote>

<p>提示：windows系统自带计算器可以帮助计算。</p>

<p>//</p>

    </section>
    </article>
  
  </ul>
  <div class="divider"></div>
  <ul class="listing main-listing">
    <li class="listing-seperator">Happened earlier this year</i>
  
  
    
    
    <li class="listing-item">
      <time datetime="2016-08-16">2016-08-16</time>
      <a href="/2016/08/16/read-tcp-segment.html" title="Read TCP segment by example">Read TCP segment by example</a>
    </li>
  
    
    
    <li class="listing-item">
      <time datetime="2016-08-12">2016-08-12</time>
      <a href="/2016/08/12/event-model-notes.html" title="Understanding the Event Model">Understanding the Event Model</a>
    </li>
  
    
    
    <li class="listing-item">
      <time datetime="2016-08-11">2016-08-11</time>
      <a href="/2016/08/11/strict-mode-notes.html" title="Some tips about Strict Mode of JavaScript">Some tips about Strict Mode of JavaScript</a>
    </li>
  
    
    
    <li class="listing-item">
      <time datetime="2016-07-22">2016-07-22</time>
      <a href="/2016/07/22/docker-vagrant-breifing.html" title="Docker and Vagrant Breifing">Docker and Vagrant Breifing</a>
    </li>
  
    
    
    <li class="listing-item">
      <time datetime="2016-07-11">2016-07-11</time>
      <a href="/2016/07/11/client-server-communication.html" title="Some tips about client-server communication">Some tips about client-server communication</a>
    </li>
  
    
    
    <li class="listing-item">
      <time datetime="2016-06-01">2016-06-01</time>
      <a href="/2016/06/01/build-grid-system-css.html" title="Let's build a simple grid system like Bootstrap">Let's build a simple grid system like Bootstrap</a>
    </li>
  
    
    
    <li class="listing-item">
      <time datetime="2016-02-23">2016-02-23</time>
      <a href="/2016/02/23/why-junit-cases-not-run-in-order.html" title="Why Junit Cases not run in order in JDK 7.">Why Junit Cases not run in order in JDK 7.</a>
    </li>
  
    
    
    <li class="listing-item">
      <time datetime="2016-02-15">2016-02-15</time>
      <a href="/2016/02/15/understand-LCS.html" title="Understand Longest Common Subsequence">Understand Longest Common Subsequence</a>
    </li>
  
    
    
    <li class="listing-item">
      <time datetime="2016-02-13">2016-02-13</time>
      <a href="/2016/02/13/http-header-note.html" title="我们走一遍http中request/response header部分">我们走一遍http中request/response header部分</a>
    </li>
  
    
    
    <li class="listing-item">
      <time datetime="2016-02-12">2016-02-12</time>
      <a href="/2016/02/12/float-point-note.html" title="二进制表示float-point">二进制表示float-point</a>
    </li>
  
    
    
    
    <li class="listing-seperator"><a href="/archive.html">Previous</a></li>
  </ul>
</div>

        </div>
        <footer>
          <div>
            
            &copy; 2015 ~ 2016 shuson | powered by jekyll | welcome fork on <a href="https://github.com/shuson/shuson.github.io" title="fork me">Github</a>
          </div>
        </footer>
      </div> <!-- main -->
      
      <script id="dsq-count-scr" src="//nevermoi.disqus.com/count.js" async></script>
  </body>
</html>
