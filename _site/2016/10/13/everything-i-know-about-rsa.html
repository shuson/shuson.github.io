<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Web, JavaScript, Blog, Nevermoi" />
    <meta property="og:site_name" content="nevermoi blog">
  
    <meta name="author" content="shuson" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    
    <title>Everything I know about RSA algorithm</title>
    
    <link rel="fav icon" href="/public/favicon.ico">
    <link href="/atom.xml" rel="alternate" title="" type="application/atom+xml" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/public/css/style.css">
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/retina.js/1.3.0/retina.min.js"></script>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script type="text/javascript"> hljs.initHighlightingOnLoad(); </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-85594317-1', 'auto');
      ga('send', 'pageview');

    </script>
  </head>
  <body>
      <div id="main" role="main">
        <header>
          <div id="header">
            <h1><a title="Nevermoi" class="" href="/">Nevermoi</a></h1>
          </div>
          <nav>
            
            <span><a title="Archive" href="/archive.html"><i class="fa fa-list-ul"></i></a></span>
            
            <span><a title="Tags" href="/tags.html"><i class="fa fa-tags"></i></a></span>
            
            <span><a title="About" href="/about.html"><i class="fa fa-user"></i></a></span>
            
            <span><a title="Subscribe" href="/atom.xml"><i class="fa fa-rss"></i></a></span>
            
          </nav>
        </header>
        <div id="content">
        <article>
  <section class="title">
    <h2>Everything I know about RSA algorithm </h2>
  </section>
  <section class="meta">
  <span class="time">
    <time datetime='2016-10-13'>2016-10-13</time>
  </span>
  
  <span class="tags">
    
    <a href="/tags.html#cryptography" title="cryptography">#cryptography</a>
    
  </span>

  
  </section>
  <section class="post">
  <h1 id="section">公开密钥加密简介</h1>
<pre><code>也称作非对称密钥加密，描述为用某用户公钥加密后所得的信息，只能用该用户的私钥才能解密。如果知道了其中一个，并不能计算出另外一个。

下面我们主要聊最常用的RSA加密算法。
</code></pre>

<h1 id="section-1">数学基础</h1>

<ol>
  <li>互质
 两个正整数，如果出了1之外没有其他公因子，这两个数就互为质数，简称互质。</li>
  <li>欧拉函数
 任意正整数n，在小于等于n的正整数中，与n互质的数的个数可记为：<img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=%5Cphi%20(n)" style="border:none;" /></li>
  <li>欧拉定理
 如果a, n互质, 则有<br />
 <img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=a%5E%7B%5Cphi(n)%7D%5Cequiv%5C1%20(mod%5C%20n)&amp;chs=60" style="border:none;" /></li>
  <li>欧拉定理的特例：费马小定理
 当p是质数，<img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=%5Cphi%20(p)%20%3D%20p%20-%201" style="border:none;" />, 则有<br />
 <img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=ab%20%5Cequiv%201%5C%20(mod%5C%20n)&amp;chs=40" style="border:none;" /></li>
  <li>模反元素
 由<br /> <img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=a%5E%7B%5Cphi(n)%7D%3Da%5Ctimes%20a%5E%7B%5Cphi(n)-1%7D%5Cequiv%5C%201%5C%20(mod%5C%20n)%20&amp;chs=40" style="border:none;" /> <br />可以写成：<br /><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=ab%20%5Cequiv%201%5C%20(mod%5C%20n)&amp;chs=40" style="border:none;" />。 <br />这个b叫做a的模反元素</li>
  <li>扩展欧几里德算法
 用来求解二元一次方程的整数解</li>
</ol>

<h1 id="rsa">生成RSA密钥</h1>
<pre><code>RSA算法的可靠性基于一个事实：两个大质数的乘积易得，但对这个乘积因式分解很困难。
</code></pre>

<ol>
  <li>随机选两个质数<br />
 例如 p=13 和 q=23. 在实际情况中，这个质数特别大。</li>
  <li>计算乘积<br />
 n = p x q = 13 x 23 = 299</li>
  <li>计算欧拉函数<br />
 φ(n) = (p-1)(q-1) = 12 x 22 = 264</li>
  <li>随机选择一个整数e，条件是1&lt; e &lt; φ(n)，且e与φ(n) 互质<br />
 e = 17</li>
  <li>计算e对于φ(n)的模反元素d <br />
 ed ≡ 1 (mod φ(n)) 等价于 k倍的 φ(n) 加上 1 等于 ed，写作 ed = kφ(n) + 1<br />
 变形为 ed + φ(n)(-k) = 1， 代入 e 和 φ(n) 的值，也就是二元一次方程 17d + 264(-k) = 1<br />
 根据扩展欧几里德算法，可得 d = 233, k = 15.</li>
  <li>至此，我们拥有了<br />
 p = 13, q = 23, n = 299, φ(n) = 264, e = 17. d = 233. <br />
 我们把n和e包装成公钥 (299, 17)，把n和d包装成私钥 (299, 233)</li>
  <li>可靠性分析<br />
 在上面的6个数字中，我们只公布了n和e，而d是最重要的私钥，如果靠n和e计算d的话<br />
    <ol>
      <li>ed≡1 (mod φ(n))。只有知道e和φ(n)，才能算出d。</li>
      <li>φ(n)=(p-1)(q-1)。只有知道p和q，才能算出φ(n)。</li>
      <li>想要知道p和q，就需要对n进行因子分解。那就难咯。</li>
    </ol>
  </li>
</ol>

<h1 id="section-2">加密和解密</h1>

<ol>
  <li>加密：有明文m，使用公钥对儿(n, e)加密得到c的过程<br />
 根据 m<sup>e</sup> ≡ c (mod n) 计算，20<sup>17</sup> ≡ 76 (mode 299), c = 76 为密文。</li>
  <li>解密：对于密文c=76, 有<br />
 c<sup>d</sup> ≡ m (mod n) 计算， 76<sup>233</sup> ≡ 20 (mode 299), 解密出m=20</li>
</ol>

<p>提示：windows系统自带计算器可以帮助计算。</p>

<p>//</p>

  </section>
  
  <div class="divider">
    <span>
    
    <a href="/2016/08/16/read-tcp-segment.html">Prev &nbsp; <i class="fa fa-chevron-left"></i></a>
    
    </span>

    <span>
    
    <i class="fa fa-circle"></i>
    
    </span>
  </div>

  
</article>


<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        this.page.url = 'http://nevermoi.com/2016/10/13/everything-i-know-about-rsa.html';
        this.page.identifier = '/2016/10/13/everything-i-know-about-rsa';
        this.page.title = 'Everything I know about RSA algorithm';
    };

    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//nevermoi.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

        </div>
        <footer>
          <div>
            
            &copy; 2015 ~ 2016 shuson | powered by jekyll | welcome fork on <a href="https://github.com/shuson/shuson.github.io" title="fork me">Github</a>
          </div>
        </footer>
      </div> <!-- main -->
      
      <script id="dsq-count-scr" src="//nevermoi.disqus.com/count.js" async></script>
  </body>
</html>
